#include "uwf.h"

void Testy(Http& h)
{
	h
	.SetCookie("mycookie", "Hello world")
	.SetCookie("mycookie2", "Test cookie *^*&^#")
	.SetCookie("mycookie3", "Cookie no. 3")
		("FIRSTNAME", "John")
	 	("LASTNAME", "Smith")
	.Render("uwf/test.whtml");
}

INITBLOCK {
	RegisterView("*", Testy);
}

String firstname, lastname;

String picture;

void Picture(Http& http)
{
	http.Content("image/png", picture);
}

void Info(Http& h)
{
	h("FIRSTNAME", firstname)
	 ("LASTNAME", lastname)
	 ("COOKIE", h["mycookie"])
	 ("PICTURE", "picture.png")
	.Render("uwf/submit.whtml");
}

INITBLOCK {
	RegisterView("info", Info);
	RegisterView("picture.png", Picture);
}

void Submit(Http& h)
{
	firstname = h["firstname"];
	lastname = h["lastname"];
	picture = h["file"];
	h.Redirect("info");
}

INITBLOCK {
	RegisterView("submit", Submit);
}
